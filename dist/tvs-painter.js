!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.tvsPainter=t():e.tvsPainter=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"GEOMETRY_PROP_POSITION",function(){return n}),r.d(t,"GEOMETRY_PROP_NORMAL",function(){return i}),r.d(t,"GEOMETRY_PROP_UV",function(){return a}),r.d(t,"UNIFORM_SOURCE_TEXTURE",function(){return u}),r.d(t,"VARYING_UV_COORDS",function(){return f}),r.d(t,"GL_TYPE",function(){return o});var n="position",i="normal",a="uv",u="source",f="coords",o={FLOAT:5126,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FLOAT_MAT2X3:35685,FLOAT_MAT2X4:35686,FLOAT_MAT3X2:35687,FLOAT_MAT3X4:35688,FLOAT_MAT4X2:35689,FLOAT_MAT4X3:35690,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT:5125,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_3D:32879,TEXTURE_2D_ARRAY:35866,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042}},function(e,t,r){"use strict";t.c=function(e,t){var r=0;function n(t,n){var i=e.getUniformLocation(t,n.name),a=n.size>1&&"[0]"===n.name.substr(-3),u=n.type,f=s[u];if(!f)throw"unknown type: 0x"+u.toString(16);if(null!=i){var o;if(null===f.Type){var _=r;r+=n.size,o=a?f.arraySetter(e,u,_,i,n.size):f.setter(e,u,_,i)}else o=f.arraySetter&&a?f.arraySetter(e,i):f.setter(e,i);return{setter:o,location:i}}}for(var i={},a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),u=0;u<a;++u){var f=e.getActiveUniform(t,u);if(!f)break;var o=f.name;if("[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3)),t){var _=n(t,f);_&&(i[o]=_)}}return i},t.b=function(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var a=e.getActiveAttrib(t,i);if(!a)break;var u=e.getAttribLocation(t,a.name),f=d[a.type],o=f.setter(e,u,f);r[a.name]={setter:o,location:u}}return r},t.e=function(e){if(e instanceof Int8Array)return n.GL_TYPE.BYTE;if(e instanceof Uint8Array)return n.GL_TYPE.UNSIGNED_BYTE;if(e instanceof Uint8ClampedArray)return n.GL_TYPE.UNSIGNED_BYTE;if(e instanceof Int16Array)return n.GL_TYPE.SHORT;if(e instanceof Uint16Array)return n.GL_TYPE.UNSIGNED_SHORT;if(e instanceof Int32Array)return n.GL_TYPE.INT;if(e instanceof Uint32Array)return n.GL_TYPE.UNSIGNED_INT;if(e instanceof Float32Array)return n.GL_TYPE.FLOAT;throw"unsupported typed array type"},t.g=S,t.h=function(e,t,r,n){if(null==t.width||null==t.height)return;null==t.frameBuffer&&(t.frameBuffer=e.createFramebuffer());t.textures||(t.textures=[]);e.bindFramebuffer(e.FRAMEBUFFER,t.frameBuffer),t.textureConfig.type===e.FLOAT&&e.getExtension("OES_texture_float");var i=t.textureConfig.count;if(i>1){for(var a=e.getExtension("WEBGL_draw_buffers")||{drawBuffersWEBGL:function(){}},u=[],f=0;f<i;f++)u.push(a["COLOR_ATTACHMENT"+f+"_WEBGL"]);a.drawBuffersWEBGL(u);for(var f=0;f<i;f++){null==t.textures[f]&&(t.textures[f]=e.createTexture());var o=t.textures[f];e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.width,t.height,0,e.RGBA,t.textureConfig.type,null),S(e,r,n),e.framebufferTexture2D(e.FRAMEBUFFER,u[f],e.TEXTURE_2D,o,0)}}else{null==t.textures[0]&&(t.textures[0]=e.createTexture());var o=t.textures[0];e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.width,t.height,0,e.RGBA,t.textureConfig.type,null),S(e,r,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,o,0)}null==t.depthBuffer&&(t.depthBuffer=e.createRenderbuffer());e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer);var _=e.checkFramebufferStatus(e.FRAMEBUFFER);_!==e.FRAMEBUFFER_COMPLETE&&console.error("framebuffer error",_,r);e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null)},t.d=function(e,t){e.deleteFramebuffer(t.frameBuffer),e.deleteRenderbuffer(t.depthBuffer);for(var r=0,n=t.textures;r<n.length;r++){var i=n[r];e.deleteTexture(i)}},t.a=function(e,t){if(t.enable)for(var r=0,n=t.enable;r<n.length;r++){var i=n[r];e.enable(i)}if(t.disable)for(var a=0,u=t.disable;a<u.length;a++){var i=u[a];e.disable(i)}t.blendFunc&&e.blendFunc.apply(e,t.blendFunc);null!=t.depthFunc&&e.depthFunc(t.depthFunc);null!=t.cullFace&&e.cullFace(t.cullFace);null!=t.frontFace&&e.frontFace(t.frontFace);null!=t.lineWidth&&e.lineWidth(t.lineWidth);t.colorMask&&e.colorMask.apply(e,t.colorMask);null!=t.depthMask&&e.depthMask(t.depthMask);t.clearColor&&e.clearColor.apply(e,t.clearColor);null!=t.clearDepth&&e.clearDepth(t.clearDepth);null!=t.clearBits&&e.clear(t.clearBits)},t.f=function(e,t){if(t.enable)for(var r=0,n=t.enable;r<n.length;r++){var i=n[r];e.disable(i)}if(t.disable)for(var a=0,u=t.disable;a<u.length;a++){var i=u[a];e.enable(i)}};var n=r(0);function i(e){return s[e].bindPoint}function a(e,t){return function(r){e.uniform1i(t,r)}}function u(e,t){return function(r){e.uniform1iv(t,r)}}function f(e,t){return function(r){e.uniform2iv(t,r)}}function o(e,t){return function(r){e.uniform3iv(t,r)}}function _(e,t){return function(r){e.uniform4iv(t,r)}}function T(e,t,r,n){var a=i(t);return function(t){e.uniform1i(n,r),e.activeTexture(e.TEXTURE0+r),e.bindTexture(a,t)}}function E(e,t,r,n,a){for(var u=i(t),f=new Int32Array(a),o=0;o<a;++o)f[o]=r+o;return function(t){for(var r in e.uniform1iv(n,f),t)e.activeTexture(e.TEXTURE0+f[r]),e.bindTexture(u,t[r])}}var s=((R={})[n.GL_TYPE.FLOAT]={Type:Float32Array,size:4,setter:function(e,t){return function(r){e.uniform1f(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1fv(t,r)}}},R[n.GL_TYPE.FLOAT_VEC2]={Type:Float32Array,size:8,setter:function(e,t){return function(r){e.uniform2fv(t,r)}}},R[n.GL_TYPE.FLOAT_VEC3]={Type:Float32Array,size:12,setter:function(e,t){return function(r){e.uniform3fv(t,r)}}},R[n.GL_TYPE.FLOAT_VEC4]={Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniform4fv(t,r)}}},R[n.GL_TYPE.INT]={Type:Int32Array,size:4,setter:a,arraySetter:u},R[n.GL_TYPE.INT_VEC2]={Type:Int32Array,size:8,setter:f},R[n.GL_TYPE.INT_VEC3]={Type:Int32Array,size:12,setter:o},R[n.GL_TYPE.INT_VEC4]={Type:Int32Array,size:16,setter:_},R[n.GL_TYPE.UNSIGNED_INT]={Type:Uint32Array,size:4,setter:function(e,t){return function(r){e.uniform1ui(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1uiv(t,r)}}},R[n.GL_TYPE.UNSIGNED_INT_VEC2]={Type:Uint32Array,size:8,setter:function(e,t){return function(r){e.uniform2uiv(t,r)}}},R[n.GL_TYPE.UNSIGNED_INT_VEC3]={Type:Uint32Array,size:12,setter:function(e,t){return function(r){e.uniform3uiv(t,r)}}},R[n.GL_TYPE.UNSIGNED_INT_VEC4]={Type:Uint32Array,size:16,setter:function(e,t){return function(r){e.uniform4uiv(t,r)}}},R[n.GL_TYPE.BOOL]={Type:Uint32Array,size:4,setter:a,arraySetter:u},R[n.GL_TYPE.BOOL_VEC2]={Type:Uint32Array,size:8,setter:f},R[n.GL_TYPE.BOOL_VEC3]={Type:Uint32Array,size:12,setter:o},R[n.GL_TYPE.BOOL_VEC4]={Type:Uint32Array,size:16,setter:_},R[n.GL_TYPE.FLOAT_MAT2]={Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniformMatrix2fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT3]={Type:Float32Array,size:36,setter:function(e,t){return function(r){e.uniformMatrix3fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT4]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT2X3]={Type:Float32Array,size:24,setter:function(e,t){return function(r){e.uniformMatrix2x3fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT2X4]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2x4fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT3X2]={Type:Float32Array,size:24,setter:function(e,t){return function(r){e.uniformMatrix3x2fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT3X4]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3x4fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT4X2]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix4x2fv(t,!1,r)}}},R[n.GL_TYPE.FLOAT_MAT4X3]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix4x3fv(t,!1,r)}}},R[n.GL_TYPE.SAMPLER_2D]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D},R[n.GL_TYPE.SAMPLER_CUBE]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_CUBE_MAP},R[n.GL_TYPE.SAMPLER_3D]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_3D},R[n.GL_TYPE.SAMPLER_2D_SHADOW]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D},R[n.GL_TYPE.SAMPLER_2D_ARRAY]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D_ARRAY},R[n.GL_TYPE.SAMPLER_2D_ARRAY_SHADOW]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D_ARRAY},R[n.GL_TYPE.SAMPLER_CUBE_SHADOW]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_CUBE_MAP},R[n.GL_TYPE.INT_SAMPLER_2D]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D},R[n.GL_TYPE.INT_SAMPLER_3D]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_3D},R[n.GL_TYPE.INT_SAMPLER_CUBE]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_CUBE_MAP},R[n.GL_TYPE.INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D_ARRAY},R[n.GL_TYPE.UNSIGNED_INT_SAMPLER_2D]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D},R[n.GL_TYPE.UNSIGNED_INT_SAMPLER_3D]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_3D},R[n.GL_TYPE.UNSIGNED_INT_SAMPLER_CUBE]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_CUBE_MAP},R[n.GL_TYPE.UNSIGNED_INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:T,arraySetter:E,bindPoint:n.GL_TYPE.TEXTURE_2D_ARRAY},R);function c(e,t,r){return function(i){e.bindBuffer(e.ARRAY_BUFFER,i.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.itemSize,n.GL_TYPE.FLOAT,i.normalize||!1,i.stride||0,i.offset||0)}}function l(e,t,r){return function(i){e.bindBuffer(e.ARRAY_BUFFER,i.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.itemSize,n.GL_TYPE.INT,i.stride||0,i.offset||0)}}function A(e,t,r){var i=r.size,a=r.count;return function(r){e.bindBuffer(e.ARRAY_BUFFER,r.buffer);for(var u=i,f=u/a,o=s[n.GL_TYPE.FLOAT].size*u,_=r.normalize||!1,T=r.offset||0,E=o/a,c=0;c<a;++c)e.enableVertexAttribArray(t+c),e.vertexAttribPointer(t+c,f,n.GL_TYPE.FLOAT,_,o,T+E*c)}}var d=((P={})[n.GL_TYPE.FLOAT]={size:4,setter:c,itemSize:1},P[n.GL_TYPE.FLOAT_VEC2]={size:8,setter:c,itemSize:2},P[n.GL_TYPE.FLOAT_VEC3]={size:12,setter:c,itemSize:3},P[n.GL_TYPE.FLOAT_VEC4]={size:16,setter:c,itemSize:4},P[n.GL_TYPE.INT]={size:4,setter:l,itemSize:1},P[n.GL_TYPE.INT_VEC2]={size:8,setter:l,itemSize:2},P[n.GL_TYPE.INT_VEC3]={size:12,setter:l,itemSize:3},P[n.GL_TYPE.INT_VEC4]={size:16,setter:l,itemSize:4},P[n.GL_TYPE.UNSIGNED_INT]={size:4,setter:l,itemSize:1},P[n.GL_TYPE.UNSIGNED_INT_VEC2]={size:8,setter:l,itemSize:2},P[n.GL_TYPE.UNSIGNED_INT_VEC3]={size:12,setter:l,itemSize:3},P[n.GL_TYPE.UNSIGNED_INT_VEC4]={size:16,setter:l,itemSize:4},P[n.GL_TYPE.BOOL]={size:4,setter:l,itemSize:1},P[n.GL_TYPE.BOOL_VEC2]={size:8,setter:l,itemSize:2},P[n.GL_TYPE.BOOL_VEC3]={size:12,setter:l,itemSize:3},P[n.GL_TYPE.BOOL_VEC4]={size:16,setter:l,itemSize:4},P[n.GL_TYPE.FLOAT_MAT2]={size:4,setter:A,count:2},P[n.GL_TYPE.FLOAT_MAT3]={size:9,setter:A,count:3},P[n.GL_TYPE.FLOAT_MAT4]={size:16,setter:A,count:4},P);var R,P,L;(L={})[n.GL_TYPE.BYTE]=Int8Array,L[n.GL_TYPE.UNSIGNED_BYTE]=Uint8Array,L[n.GL_TYPE.SHORT]=Int16Array,L[n.GL_TYPE.UNSIGNED_SHORT]=Uint16Array,L[n.GL_TYPE.INT]=Int32Array,L[n.GL_TYPE.UNSIGNED_INT]=Uint32Array,L[n.GL_TYPE.FLOAT]=Float32Array,L[n.GL_TYPE.UNSIGNED_SHORT_4_4_4_4]=Uint16Array,L[n.GL_TYPE.UNSIGNED_SHORT_5_5_5_1]=Uint16Array,L[n.GL_TYPE.UNSIGNED_SHORT_5_6_5]=Uint16Array,L[n.GL_TYPE.HALF_FLOAT]=Uint16Array,L[n.GL_TYPE.UNSIGNED_INT_2_10_10_10_REV]=Uint32Array,L[n.GL_TYPE.UNSIGNED_INT_10F_11F_11F_REV]=Uint32Array,L[n.GL_TYPE.UNSIGNED_INT_5_9_9_9_REV]=Uint32Array,L[n.GL_TYPE.FLOAT_32_UNSIGNED_INT_24_8_REV]=Uint32Array,L[n.GL_TYPE.UNSIGNED_INT_24_8]=Uint32Array;function S(e,t,r){if(void 0===t&&(t={}),void 0===r&&(r={}),null!=t.flipY&&t.flipY!==r.flipY&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),t.wrap&&t.wrap!==r.wrap||t.wrapS&&t.wrapS!==r.wrapS||t.wrapT&&t.wrapT!==r.wrapT){var n=void 0,i=void 0;t.wrap?n=i=t.wrap:(i=t.wrapT||"CLAMP_TO_EDGE",n=t.wrapS||"CLAMP_TO_EDGE"),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e[n]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e[i])}t.magFilter&&t.magFilter!==r.magFilter&&e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[t.magFilter]),t.minFilter&&t.minFilter!==r.minFilter&&e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[t.minFilter])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContext=function(e){var t=e.getContext("webgl")||e.getContext("experimental-webgl");if(null==t)throw Error("Webgl context cannot be initialized");return t},t.makeClear=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce(function(t,r){return t|e[r.toUpperCase()+"_BUFFER_BIT"]},0)},t.setBlendFunc=function(e,t){e.blendFunc.apply(e,t.map(function(t){return e[t.toUpperCase()]}))},t.resizeCanvas=function(e,t){void 0===t&&(t=1);t=Math.max(1,t);var r=e.clientWidth*t|0,n=e.clientHeight*t|0;if(e.width!==r||e.height!==n)return e.width=r,e.height=n,!0;return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"defaultTextureSettings",function(){return i}),t.getDefaultLayerSettings=function(e){return{clearColor:[0,0,0,1],enable:[e.DEPTH_TEST],blendFunc:[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA]}},r.d(t,"defaultForms",function(){return u}),r.d(t,"defaultShaders",function(){return f});var n=r(0),i={wrap:"CLAMP_TO_EDGE",minFilter:"LINEAR",magFilter:"NEAREST"};var a,u={renderQuad:{attribs:(a={},a[n.GEOMETRY_PROP_POSITION]={buffer:new Float32Array([-1,1,-1,-1,1,1,1,-1]),storeType:"STATIC"},a[n.GEOMETRY_PROP_UV]={buffer:new Float32Array([0,1,0,0,1,1,1,0]),storeType:"STATIC"},a),drawType:"TRIANGLE_STRIP",itemCount:4}},f={basicEffect:{vert:"\n\t\t\tattribute vec2 "+n.GEOMETRY_PROP_POSITION+";\n\t\t\tattribute vec2 "+n.GEOMETRY_PROP_UV+";\n\t\t\tvarying vec2 "+n.VARYING_UV_COORDS+";\n\t\t\tvoid main() {\n\t\t\t\t"+n.VARYING_UV_COORDS+" = "+n.GEOMETRY_PROP_UV+";\n\t\t\t\tgl_Position = vec4("+n.GEOMETRY_PROP_POSITION+", 0.0, 1.0);\n\t\t\t}",frag:"precision mediump float;\n\t\t\tuniform sampler2D "+n.UNIFORM_SOURCE_TEXTURE+";\n\t\t\tvarying vec2 "+n.VARYING_UV_COORDS+";\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D("+n.UNIFORM_SOURCE_TEXTURE+", "+n.VARYING_UV_COORDS+");\n\t\t\t}"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"utils",function(){return i}),r.d(t,"lib",function(){return a}),r.d(t,"constants",function(){return u}),r.d(t,"painter",function(){return f});var n=r(0),i={geometry:{plane:r(5)},stackgl:r(6),context:r(2)},a=r(3),u=n,f=r(9);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plane=function(e,t,r,n){var i,a,u=e/2,f=t/2,o=r||1,_=n||1,T=o+1,E=_+1,s=e/o,c=t/_,l=new Float32Array(T*E*3),A=new Float32Array(T*E*3),d=new Float32Array(T*E*2),R=0,P=0;for(i=0;i<E;i++){var L=i*c-f;for(a=0;a<T;a++){var S=a*s-u;l[R]=S,l[R+1]=-L,A[R+2]=1,d[P]=a/o,d[P+1]=1-i/_,R+=3,P+=2}}R=0;var m=new(l.length/3>65535?Uint32Array:Uint16Array)(o*_*6);for(i=0;i<_;i++)for(a=0;a<o;a++){var y=a+T*i,O=a+T*(i+1),G=a+1+T*(i+1),p=a+1+T*i;m[R]=y,m[R+1]=O,m[R+2]=p,m[R+3]=O,m[R+4]=G,m[R+5]=p,R+=6}return{attribs:{position:{buffer:l},normal:{buffer:A},uv:{buffer:d}},elements:{buffer:m},drawType:"TRIANGLES",itemCount:m.length}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"STACK_GL_GEOMETRY_PROP_POSITION",function(){return a}),r.d(t,"STACK_GL_GEOMETRY_PROP_NORMAL",function(){return u}),r.d(t,"STACK_GL_GEOMETRY_PROP_UV",function(){return f}),r.d(t,"STACK_GL_GEOMETRY_PROP_ELEMENTS",function(){return o}),t.convertStackGLGeometry=function(e){var t={drawType:"TRIANGLES",attribs:{},itemCount:0};for(var r in e){var _=e[r];if(r===o){var T=new(_.length>65535?Uint32Array:Uint16Array)(Object(i.a)(_));Object.assign(t,{elements:{buffer:T},itemCount:T.length})}else r===a?t.attribs[n.GEOMETRY_PROP_POSITION]={buffer:new Float32Array(Object(i.a)(_))}:r===u?t.attribs[n.GEOMETRY_PROP_NORMAL]={buffer:new Float32Array(Object(i.a)(_))}:r===f?t.attribs[n.GEOMETRY_PROP_UV]={buffer:new Float32Array(Object(i.a)(_))}:t.attribs[r]={buffer:new Float32Array(Object(i.a)(_))}}return t};var n=r(0),i=r(7),a="positions",u="normals",f="uvs",o="cells"},function(e,t,r){"use strict";t.a=n;r(8);function n(e,t){void 0===t&&(t=[]);for(var r=0,n=e;r<n.length;r++)for(var i=n[r],a=t.length,u=0;u<i.length;u++)t[u+a]=i[u];return t}},function(e,t,r){"use strict";function n(e){return Math.floor(Math.random()*e)}t.a=n,t.b=function(e,t){return n(t-e)+e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(e){var t=[{},{}],r=Object(_.getDefaultLayerSettings)(e),s=n.a(e).update(_.defaultForms.renderQuad),c=function(){return a.a().update({form:s,shade:i.a(e).update(_.defaultShaders.basicEffect)})},l=c(),A=function(r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var i=e.canvas,a=Object(o.resizeCanvas)(i,r);return(a||n)&&t.forEach(function(t){t.width=i.width,t.height=i.height,t.textureConfig={count:1,type:e.UNSIGNED_BYTE},Object(f.h)(e,t,_.defaultTextureSettings)}),d};A(1,!0);var d={gl:e,updateDrawSettings:function(t){return Object(f.a)(e,T({},r,t)),d},createForm:function(){return n.a(e)},createShade:function(){return i.a(e)},createSketch:function(){return a.a()},createFlatSketch:c,createStaticLayer:function(){return u.b(e)},createDrawingLayer:function(){return u.a(e)},createEffectLayer:function(){return u.a(e).update({sketches:[c()]})},draw:function(t,r){return E(e,t,null,r),d},compose:function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return function(e,t,r,n){for(var i=t.length-1,a=function(a){var u=t[a],o=function(t,i){var a=r[0],o=r[1],_=!i&&null==u.target;if(i?(e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight)):u.target?(e.bindFramebuffer(e.FRAMEBUFFER,u.target.frameBuffer),e.viewport(0,0,u.target.width,u.target.height)):(e.bindFramebuffer(e.FRAMEBUFFER,o.frameBuffer),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight)),u.data.drawSettings&&Object(f.a)(e,u.data.drawSettings),u.sketches)for(var T=0,s=u.sketches;T<s.length;T++){var c=s[T];E(e,c,a.textures[0],t)}else E(e,n,null,{source:u.texture()});u.data.drawSettings&&Object(f.f)(e,u.data.drawSettings),_&&(r[0]=o,r[1]=a)};if(Array.isArray(u.uniforms))for(var _=i+u.uniforms.length-1,T=0;T<u.uniforms.length;T++){var s=a+T===_;o(u.uniforms[T],s)}else{var s=a===i;o(u.uniforms,s)}},u=0;u<t.length;u++)a(u)}(e,r,t,l),d},resize:A,destroy:function(){l.destroy();for(var r=0,n=t;r<n.length;r++){var i=n[r];Object(f.d)(e,i)}}};return d};var n=r(10),i=r(11),a=r(12),u=r(13),f=r(1),o=r(2),_=r(3),T=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};function E(e,t,r,n){var i=t.shade,a=t.uniforms,u=t.form,o=t.drawSettings;if(!i||!u)throw Error("cannot draw, shader or geometry are not set");if(e.useProgram(i.program),function(e,t){for(var r in t.attribs){var n=e.attributeSetters[r];n&&n.setter(t.attribs[r])}}(i,u),n&&c(i,n,r),o&&Object(f.a)(e,o),Array.isArray(a))for(var _=0,T=a;_<T.length;_++){s(e,t,r,T[_])}else s(e,t,r,a);o&&Object(f.f)(e,o)}function s(e,t,r,n){n&&c(t.shade,n,r),t.form.elements&&null!=t.form.elements.glType?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.form.elements.buffer),e.drawElements(t.form.drawType,t.form.itemCount,t.form.elements.glType,0)):e.drawArrays(t.form.drawType,0,t.form.itemCount)}function c(e,t,r){for(var n in t){var i=e.uniformSetters[n];if(i){var a=t[n];null===a||"string"==typeof a?i.setter(r):i.setter(a)}}}},function(e,t,r){"use strict";t.a=function(e){var t={};return t.update=function(r){r.drawType&&(t.drawType=e[r.drawType]),r.itemCount&&(t.itemCount=r.itemCount);var i=t.attribs||{};for(var a in r.attribs){var u=r.attribs[a];null==i[a]&&(i[a]={buffer:e.createBuffer()}),e.bindBuffer(e.ARRAY_BUFFER,i[a].buffer),e.bufferData(e.ARRAY_BUFFER,u.buffer,e[(u.storeType||"STATIC")+"_DRAW"])}if(t.attribs=i,r.elements){var f=r.elements.buffer;null==t.elements&&(t.elements={buffer:e.createBuffer(),glType:null}),t.elements.glType=Object(n.e)(f),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.elements.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,f,e[(r.elements.storeType||"STATIC")+"_DRAW"])}return t},t.destroy=function(){for(var r in t.attribs)e.deleteBuffer(t.attribs[r].buffer);return t.elements&&e.deleteBuffer(t.elements.buffer),t},t};var n=r(1)},function(e,t,r){"use strict";t.a=function(e){var t={program:e.createProgram(),frag:e.createShader(e.FRAGMENT_SHADER),vert:e.createShader(e.VERTEX_SHADER)};return e.attachShader(t.program,t.vert),e.attachShader(t.program,t.frag),t.update=function(r){var a=r.frag&&r.frag.trim()||t.fragSource,u=r.vert&&r.vert.trim()||t.vertSource;if(!a||!u)return t;if(a.indexOf("GL_EXT_draw_buffers")>=0&&e.getExtension("WEBGL_draw_buffers"),e.shaderSource(t.vert,u),e.shaderSource(t.frag,a),e.compileShader(t.vert),e.compileShader(t.frag),e.getShaderParameter(t.vert,e.COMPILE_STATUS)||console.error("Error Compiling Vertex Shader!\n",e.getShaderInfoLog(t.vert),i(u)),e.getShaderParameter(t.frag,e.COMPILE_STATUS)||console.error("Error Compiling Fragment Shader!\n",e.getShaderInfoLog(t.frag),i(a)),e.linkProgram(t.program),!e.getProgramParameter(t.program,e.LINK_STATUS)){var f=e.getProgramInfoLog(t.program);console.error("Error in program linking:",f)}return t.uniformSetters=Object(n.c)(e,t.program),t.attributeSetters=Object(n.b)(e,t.program),t.fragSource=a,t.vertSource=u,t},t.destroy=function(){e.deleteProgram(t.program),e.deleteShader(t.frag),e.deleteShader(t.vert)},t};var n=r(1);function i(e){return e.trim().split("\n").map(function(e,t){return t+1+": "+e}).join("\n")}},function(e,t,r){"use strict";t.a=function(){var e={};return e.update=function(t){return t.drawSettings&&(e.drawSettings=t.drawSettings),t.form&&(e.form=t.form),t.shade&&(e.shade=t.shade),t.uniforms&&(e.uniforms=t.uniforms),e},e.destroy=function(){e.form&&e.form.destroy(),e.shade&&e.shade.destroy()},e}},function(e,t,r){"use strict";t.b=function(e){var t={},r=e.createTexture();return t.textures=[r],t.data={},t.texture=function(){return r},t.update=function(i){return e.bindTexture(e.TEXTURE_2D,r),Object(n.g)(e,i,t.data),i.asset&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i.asset),i.minFilter&&i.minFilter.indexOf("MIPMAP")>0&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),Object.assign(t.data,i),t},t.destroy=function(){e.deleteTexture(r)},t},t.a=function(e){var t={textures:[],data:{}};return t.texture=function(e){return void 0===e&&(e=0),t.textures[e]},t.update=function(r){if(r.buffered&&!t.target?(t.target={width:r.width||e.canvas.width,height:r.height||e.canvas.height,frameBuffer:null,textures:[],depthBuffer:null,textureConfig:{type:r.textureConfig&&r.textureConfig.type||e.UNSIGNED_BYTE,count:r.textureConfig&&r.textureConfig.count||1}},Object(n.h)(e,t.target,r,t.data),t.textures=t.target.textures):t.target&&r.width&&r.height&&(t.target.width=r.width,t.target.height=r.height,Object(n.h)(e,t.target,r,t.data)),r.sketches&&(t.sketches=r.sketches),r.frag){var i=t.sketches&&t.sketches[0];i&&i.shade.update({frag:r.frag})}return r.uniforms&&(t.uniforms=r.uniforms),Object.assign(t.data,r),t},t.destroy=function(){if(t.sketches)for(var r=0,i=t.sketches;r<i.length;r++)i[r].destroy();if(t.target)Object(n.d)(e,t.target);else for(var a=0,u=t.textures;a<u.length;a++){var f=u[a];e.deleteTexture(f)}},t};var n=r(1)}])});